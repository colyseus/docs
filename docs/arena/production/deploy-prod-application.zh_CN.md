# 最佳實踐

!!! NOTE    
    - 這是我們目前關於在生產環境中使用 Arena 的建議，未來的更新將簡化此過程並允許從單一部署中進行正常滾動更新。

## 在生產中使用 Arena 部署
以下是我們為 Arena Cloud 應用程式的高可用性伺服器部署推薦的兩種設計模式。

### A / B 伺服器部署
在此部署模式中，您將需要建立兩個應用程式部署。我們將其命名為 ***MOBA A*** 和 ***MOBA B***。關於伺服器流量，在給定時間只有這些部署之一處於活動狀態。關於此示例，假設 MOBA A 是目前使用的部署。此設定要求您作為開發人員能夠動態更新遊戲客戶端上的伺服器位址。

- **維護窗口更新：**您的遊戲伺服器是空的，因為您正處於遊戲的預定維護時段。在此情況下，您將更新 ***MOBA A*** 上的遊戲伺服器代碼並重新啟動部署以使更改生效。由於沒有連接玩家，因此不會中斷遊戲會話。  

- **重要修補程式/熱修復更新：**發現了一個可能影響遊戲平衡或導致某些客戶端不穩定的重大錯誤。在此情況下，您希望更新新遊戲的代碼而不終止正在進行的遊戲會話。為此，您首先需要將代碼更改上傳並部署到 ***MOBA B***。確認已部署更新後，您可以更新後端服務以使用新的 ***MOBA B*** 連線 URL 更新遊戲用戶端。新遊戲將被路由到更新的代碼庫並使用更新的代碼庫建立，舊遊戲會話可以在 ***MOBA A*** 部署上正常完成其會話。

!!! NOTE    
    - 如果您選擇使用此方法，將調整計費以確保您只為 ACTIVE 部署付費。A / B 設定所需的最低空閒部署不會不收取額外費用。


### 動態伺服器部署（僅適用於 To Mars (TM) 及更高版本）
此部署模式可用於單一應用程式部署，但確實有一些限制。此系統還需要我們的支援團隊設定自定義參數以確保其按預期工作，請聯絡 [support@lucidsight.com](mailto:support@lucidsight.com) 了解更多資訊並部署此服務。關於以下示例，我們將此部署稱為 ***MOBA SINGLE***。

- **維護窗口更新：**您的遊戲伺服器是空的，因為您正處於遊戲的預定維護時段。在此情況下，您將更新 ***MOBA SINGLE*** 上的遊戲伺服器代碼並重新啟動部署以使更改生效。由於沒有連接玩家，因此不會中斷遊戲會話。  

- **重要修補程式/熱修復更新：**發現了一個可能影響遊戲平衡或導致某些客戶端不穩定的重大錯誤。在此情況下，您希望更新新遊戲的代碼而不終止正在進行的遊戲會話。為此，您需要將代碼上傳到 ***MOBA SINGLE*** 應用程式。在部署代碼時，您***不***可選擇*上傳部署*，而是應該選擇部署。部署過程完成後，***X*** 個新伺服器將新增到您現有的伺服器池中，並由 Arena Load Balancer 優先處理新流量。新的流量將自動放置在最新的伺服器中，舊伺服器在 10 分鐘不活動後會縮小規模。***X*** 可以是預定義的數量或匹配執行的伺服器數量。


